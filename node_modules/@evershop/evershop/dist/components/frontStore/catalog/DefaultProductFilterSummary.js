import { _ } from '@evershop/evershop/lib/locale/translate/_';
import React from 'react';
export const formatPrice = (oldFormatted, price) => {
    const match = oldFormatted.match(/^[^\d.,]+/);
    const currencySymbol = match ? match[0] : '';
    return currencySymbol + price;
};
export const getFilterSummary = (availableAttributes, currentFilters, priceRange, categories) => {
    const summaries = [];
    // Price filters
    const minPrice = currentFilters.find((f) => f.key === 'min_price');
    const maxPrice = currentFilters.find((f) => f.key === 'max_price');
    if (minPrice || maxPrice) {
        const min = (minPrice === null || minPrice === void 0 ? void 0 : minPrice.value) || (priceRange === null || priceRange === void 0 ? void 0 : priceRange.min.toString()) || '0';
        const max = (maxPrice === null || maxPrice === void 0 ? void 0 : maxPrice.value) || (priceRange === null || priceRange === void 0 ? void 0 : priceRange.max.toString()) || 'âˆž';
        summaries.push(_('Price: ${value}', {
            value: `${formatPrice(priceRange.minText, parseInt(min))} - ${formatPrice(priceRange.maxText, parseInt(max))}`
        }));
    }
    const categoryFilter = currentFilters.find((f) => f.key === 'cat');
    if (categoryFilter) {
        const selectedCategoryIds = categoryFilter.value.split(',');
        const selectedCategories = categories.filter((cat) => selectedCategoryIds.includes(cat.categoryId.toString()));
        if (selectedCategories.length > 0) {
            summaries.push(`${_('Categories')}: ${selectedCategories
                .map((c) => c.name)
                .join(', ')}`);
        }
    }
    availableAttributes.forEach((attr) => {
        const filter = currentFilters.find((f) => f.key === attr.attributeCode);
        if (filter) {
            const selectedOptionIds = filter.value.split(',');
            const selectedOptions = attr.options.filter((opt) => selectedOptionIds.includes(opt.optionId.toString()));
            if (selectedOptions.length > 0) {
                summaries.push(`${attr.attributeName}: ${selectedOptions
                    .map((o) => o.optionText)
                    .join(', ')}`);
            }
        }
    });
    return summaries;
};
export const DefaultProductFilterSummary = ({ availableAttributes, currentFilters, priceRange, categories }) => {
    const filterSummary = getFilterSummary(availableAttributes, currentFilters, priceRange, categories);
    if (filterSummary.length === 0) {
        return null;
    }
    return (React.createElement("div", { className: "active-filters mb-4 p-3 bg-blue-50 rounded-lg" },
        React.createElement("div", { className: "text-sm font-medium text-blue-900 mb-2" },
            _('Active Filters'),
            ":"),
        React.createElement("div", { className: "space-y-1" }, filterSummary.map((summary, index) => (React.createElement("div", { key: index, className: "text-sm text-blue-800" }, summary))))));
};
//# sourceMappingURL=DefaultProductFilterSummary.js.map