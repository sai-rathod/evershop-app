import Button from '@components/common/Button.js';
import { Form } from '@components/common/form/Form.js';
import { InputField } from '@components/common/form/InputField.js';
import { Coupon } from '@components/frontStore/Coupon.js';
import { _ } from '@evershop/evershop/lib/locale/translate/_';
import React from 'react';
import { useForm } from 'react-hook-form';
import { toast } from 'react-toastify';
export function CouponForm() {
    const form = useForm();
    const coupon = form.watch('coupon');
    return (React.createElement(Coupon, { onApplySuccess: () => {
            toast.success(_('Coupon applied successfully!'));
        }, onError: () => {
            toast.error(_('Invalid coupon'));
        }, onRemoveSuccess: () => {
            toast.success(_('Coupon removed successfully!'));
        } }, (state, actions) => (React.createElement("div", { className: "coupon-form" },
        React.createElement(Form, { form: form, method: "POST", submitBtn: false },
            React.createElement("div", { className: "flex justify-between gap-3" },
                React.createElement("div", { className: "w-4/5" },
                    React.createElement(InputField, { name: "coupon", required: true, validation: {
                            required: {
                                value: true,
                                message: _('Coupon code is required')
                            }
                        }, defaultValue: state.appliedCoupon || '', disabled: !!state.appliedCoupon, placeholder: _('Enter coupon code'), wrapperClassName: "mb-0 form-field" })),
                React.createElement("div", { className: "col-span-1" },
                    React.createElement(Button, { title: state.appliedCoupon ? _('Remove') : _('Apply'), isLoading: state.isLoading, onAction: async () => {
                            if (state.appliedCoupon) {
                                await actions.removeCoupon();
                            }
                            else {
                                const isValid = await form.trigger();
                                if (isValid) {
                                    actions.applyCoupon(coupon);
                                }
                            }
                        }, variant: state.appliedCoupon ? 'danger' : 'primary', className: "text-base" }))))))));
}
//# sourceMappingURL=CouponForm.js.map