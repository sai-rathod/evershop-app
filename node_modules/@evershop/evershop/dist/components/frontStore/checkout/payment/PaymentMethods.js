/* eslint-disable jsx-a11y/click-events-have-key-events, jsx-a11y/no-static-element-interactions */
import { useCheckout } from '@components/frontStore/checkout/CheckoutContext.js';
import { _ } from '@evershop/evershop/lib/locale/translate/_';
import React from 'react';
// Skeleton component for loading state
function PaymentMethodSkeleton() {
    return (React.createElement("div", { className: "payment-method-skeleton" }, [1, 2, 3, 4].map((index) => (React.createElement("div", { key: index, className: "border border-gray-200 rounded-lg p-4 mb-3 animate-pulse" },
        React.createElement("div", { className: "flex items-center justify-between" },
            React.createElement("div", { className: "flex items-center space-x-3" },
                React.createElement("div", { className: "w-4 h-4 bg-gray-200 rounded-full" }),
                React.createElement("div", { className: "space-y-2" },
                    React.createElement("div", { className: "h-4 bg-gray-200 rounded w-20" }),
                    React.createElement("div", { className: "h-3 bg-gray-200 rounded w-40" }))),
            React.createElement("div", { className: "text-right space-y-1" },
                React.createElement("div", { className: "h-3 bg-gray-200 rounded w-12" }),
                React.createElement("div", { className: "h-4 bg-gray-200 rounded w-16" }))))))));
}
export function PaymentMethods({ methods, isLoading }) {
    var _a, _b;
    const { form, registeredPaymentComponents } = useCheckout();
    const { register, formState, watch, setValue } = form;
    // Watch the current payment method value
    const selectedPaymentMethod = watch('paymentMethod');
    // Helper function to get payment component for a method
    const getPaymentComponent = (methodCode) => {
        return registeredPaymentComponents[methodCode] || null;
    };
    // Helper function to render a component safely
    const renderComponent = (component, props) => {
        return component ? React.createElement(component, props) : null;
    };
    return (React.createElement("div", { className: "checkout-payment-methods" }, isLoading ? (React.createElement(PaymentMethodSkeleton, null)) : (React.createElement(React.Fragment, null,
        React.createElement("div", { className: "payment-methods-list" }, (methods === null || methods === void 0 ? void 0 : methods.length) === 0 ? (React.createElement("div", { className: "text-gray-500 text-center py-8" },
            React.createElement("div", { className: "mb-2" }, _('No payment methods available')))) : (methods.map((method) => {
            const isSelected = selectedPaymentMethod === method.code;
            const component = getPaymentComponent(method.code);
            return (React.createElement("div", { key: method.code, className: `border rounded-lg mb-3 transition-all overflow-hidden duration-200 ${isSelected
                    ? 'border-blue-500 bg-blue-50'
                    : 'border-gray-200 hover:border-gray-300'}` },
                React.createElement("div", { className: "p-3" },
                    React.createElement("div", { className: "flex items-center space-x-3" },
                        React.createElement("input", { type: "radio", ...register('paymentMethod'), value: method.code, required: true, checked: isSelected, className: "w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500" }),
                        React.createElement("div", { className: "font-normal text-gray-900 w-full cursor-pointer", onClick: (e) => {
                                e.preventDefault();
                                if (formState.disabled) {
                                    return;
                                }
                                // Set selected payment method
                                setValue('paymentMethod', method.code);
                            } }, (component === null || component === void 0 ? void 0 : component.nameRenderer)
                            ? renderComponent(component.nameRenderer, {
                                isSelected
                            })
                            : _(method.name)))),
                isSelected && (component === null || component === void 0 ? void 0 : component.formRenderer) && (React.createElement("div", { className: "border-t border-gray-200 p-3 bg-white" }, renderComponent(component.formRenderer, {
                    isSelected: true
                })))));
        }))),
        formState.errors.paymentMethod && (React.createElement("div", { className: "text-red-500 text-sm mt-2" }, ((_b = (_a = formState.errors.paymentMethod) === null || _a === void 0 ? void 0 : _a.message) === null || _b === void 0 ? void 0 : _b.toString()) ||
            _('Please select a payment method')))))));
}
//# sourceMappingURL=PaymentMethods.js.map