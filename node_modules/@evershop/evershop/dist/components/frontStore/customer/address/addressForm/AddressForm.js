import Area from '@components/common/Area.js';
import { InputField } from '@components/common/form/InputField.js';
import { SelectField } from '@components/common/form/SelectField.js';
import { NameAndTelephone } from '@components/frontStore/customer/address/addressForm/NameAndTelephone.js';
import { ProvinceAndPostcode } from '@components/frontStore/customer/address/addressForm/ProvinceAndPostcode.js';
import { _ } from '@evershop/evershop/lib/locale/translate/_';
import React from 'react';
import { useFormContext } from 'react-hook-form';
export function CustomerAddressForm({ allowCountries = [], address = {}, areaId = 'customerAddressForm', fieldNamePrefix = 'address' }) {
    var _a, _b, _c;
    const { watch, setValue } = useFormContext();
    const getFieldName = (fieldName) => {
        return fieldNamePrefix ? `${fieldNamePrefix}.${fieldName}` : fieldName;
    };
    const selectedCountry = watch(getFieldName('country'), ((_a = address === null || address === void 0 ? void 0 : address.country) === null || _a === void 0 ? void 0 : _a.code) || '');
    return (React.createElement(Area, { id: areaId, coreComponents: [
            {
                component: {
                    default: (React.createElement(NameAndTelephone, { fullName: (address === null || address === void 0 ? void 0 : address.fullName) || '', telephone: (address === null || address === void 0 ? void 0 : address.telephone) || '', getFieldName: getFieldName }))
                },
                sortOrder: 10
            },
            {
                component: {
                    default: (React.createElement(InputField, { name: getFieldName('address_1'), label: _('Address'), placeholder: _('Address'), defaultValue: (address === null || address === void 0 ? void 0 : address.address1) || '', required: true, validation: {
                            required: _('Address is required')
                        } }))
                },
                sortOrder: 20
            },
            {
                component: {
                    default: (React.createElement(InputField, { name: getFieldName('address_2'), label: _('Address 2'), placeholder: _('Address 2'), defaultValue: (address === null || address === void 0 ? void 0 : address.address2) || '' }))
                },
                sortOrder: 30
            },
            {
                component: {
                    default: (React.createElement(InputField, { name: getFieldName('city'), label: _('City'), placeholder: _('City'), defaultValue: (address === null || address === void 0 ? void 0 : address.city) || '' }))
                },
                sortOrder: 40
            },
            {
                component: {
                    default: (React.createElement(SelectField, { defaultValue: ((_b = address === null || address === void 0 ? void 0 : address.country) === null || _b === void 0 ? void 0 : _b.code) || '', label: _('Country'), name: getFieldName('country'), placeholder: _('Country'), onChange: (value) => {
                            setValue(getFieldName('country'), value.target.value);
                            setValue(getFieldName('province'), '');
                        }, required: true, validation: { required: _('Country is required') }, options: allowCountries }))
                },
                sortOrder: 50
            },
            {
                component: {
                    default: (React.createElement(ProvinceAndPostcode, { provinces: ((_c = allowCountries.find((country) => country.value === selectedCountry)) === null || _c === void 0 ? void 0 : _c.provinces) || [], province: (address === null || address === void 0 ? void 0 : address.province) || { code: '' }, postcode: (address === null || address === void 0 ? void 0 : address.postcode) || '', getFieldName: getFieldName }))
                },
                sortOrder: 60
            }
        ] }));
}
//# sourceMappingURL=AddressForm.js.map