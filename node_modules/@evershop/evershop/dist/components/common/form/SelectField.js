import { Tooltip } from '@components/common/form/Tooltip.js';
import { getNestedError } from '@components/common/form/utils/getNestedError.js';
import { _ } from '@evershop/evershop/lib/locale/translate/_';
import React from 'react';
import { useFormContext } from 'react-hook-form';
export function SelectField({ name, label, error, helperText, required, validation, options, placeholder, wrapperClassName, className, defaultValue, multiple = false, ...props }) {
    const { register, formState: { errors } } = useFormContext();
    const fieldError = getNestedError(name, errors, error);
    const fieldId = `field-${name}`;
    const hasDefaultValue = defaultValue !== undefined && defaultValue !== null && defaultValue !== '';
    const validationRules = {
        ...validation,
        ...(required &&
            !(validation === null || validation === void 0 ? void 0 : validation.required) && {
            required: {
                value: true,
                message: _('${field} is required', { field: label || name })
            },
            validate: {
                ...validation === null || validation === void 0 ? void 0 : validation.validate,
                notEmpty: (value) => {
                    if (required &&
                        (value === '' || value === null || value === undefined)) {
                        return _('${field} is required', { field: label || name });
                    }
                    return true;
                }
            }
        })
    };
    return (React.createElement("div", { className: `form-field ${wrapperClassName} ${fieldError ? 'error' : ''}` },
        label && (React.createElement("label", { htmlFor: fieldId },
            label,
            required && React.createElement("span", { className: "required-indicator" }, "*"),
            helperText && React.createElement(Tooltip, { content: helperText, position: "top" }))),
        React.createElement("select", { id: fieldId, ...register(name, validationRules), className: className, defaultValue: hasDefaultValue ? defaultValue : multiple ? [] : '', "aria-invalid": fieldError !== undefined ? 'true' : 'false', "aria-describedby": fieldError !== undefined
                ? `${fieldId}-error`
                : helperText
                    ? `${fieldId}-helper`
                    : undefined, multiple: multiple, ...props },
            placeholder && (React.createElement("option", { value: "", disabled: true }, placeholder)),
            options.map((option) => (React.createElement("option", { key: option.value, value: option.value, disabled: option.disabled }, option.label)))),
        fieldError && (React.createElement("p", { id: `${fieldId}-error`, className: "field-error" }, fieldError))));
}
//# sourceMappingURL=SelectField.js.map