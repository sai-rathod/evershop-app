import { Card } from '@components/admin/Card.js';
import Spinner from '@components/admin/Spinner.js';
import Button from '@components/common/Button.js';
import { Form } from '@components/common/form/Form.js';
import { InputField } from '@components/common/form/InputField.js';
import { NumberField } from '@components/common/form/NumberField.js';
import { ToggleField } from '@components/common/form/ToggleField.js';
import React from 'react';
import { toast } from 'react-toastify';
import { useQuery } from 'urql';
const MethodsQuery = `
  query Methods {
    shippingMethods {
      value: shippingMethodId
      label: name
    }
    createShippingMethodApi: url(routeId: "createShippingMethod")
  }
`;
function RateForm({ saveRateApi, closeModal, getTaxClasses, rate }) {
    const [result] = useQuery({
        query: MethodsQuery
    });
    if (result.fetching) {
        return (React.createElement("div", { className: "flex justify-center p-2" },
            React.createElement(Spinner, { width: 25, height: 25 })));
    }
    return (React.createElement(Card, null,
        React.createElement(Form, { id: "taxRateForm", method: rate ? 'PATCH' : 'POST', action: saveRateApi, submitBtn: false, onSuccess: async (response) => {
                if (!response.error) {
                    await getTaxClasses({ requestPolicy: 'network-only' });
                    closeModal();
                    toast.success('Tax rate has been saved successfully!');
                }
                else {
                    toast.error(response.error.message);
                }
            } },
            React.createElement(Card.Session, { title: "Basic" },
                React.createElement("div", { className: "grid grid-cols-2 gap-5" },
                    React.createElement("div", null,
                        React.createElement(InputField, { name: "name", placeholder: "Name", required: true, validation: { required: 'Name is required' }, label: "Name", defaultValue: rate === null || rate === void 0 ? void 0 : rate.name })),
                    React.createElement("div", null,
                        React.createElement(NumberField, { name: "rate", label: "Rate", placeholder: "Rate", required: true, validation: { required: 'Rate is required' }, defaultValue: rate === null || rate === void 0 ? void 0 : rate.rate })))),
            React.createElement(Card.Session, { title: "Setup shipping cost" },
                React.createElement("div", { className: "grid grid-cols-3 gap-5" },
                    React.createElement("div", null,
                        React.createElement(InputField, { name: "country", label: "Country", placeholder: "Country", validation: { required: 'Country is required' }, defaultValue: rate === null || rate === void 0 ? void 0 : rate.country, helperText: 'Country code (e.g., "US"). Use "*" for all countries.' })),
                    React.createElement("div", null,
                        React.createElement(InputField, { name: "province", label: "Provinces", placeholder: "Provinces", validation: { required: 'Provinces is required' }, defaultValue: rate === null || rate === void 0 ? void 0 : rate.province, helperText: 'Province code (e.g., "CA"). Use "*" for all provinces.' })),
                    React.createElement("div", null,
                        React.createElement(InputField, { name: "postcode", label: "Postcode", placeholder: "Postcode", validation: { required: 'Postcode is required' }, defaultValue: rate === null || rate === void 0 ? void 0 : rate.postcode, helperText: 'Postcode (e.g., "90210"). Empty for all postcodes.' }))),
                React.createElement("div", { className: "grid grid-cols-2 gap-5 mt-5" },
                    React.createElement("div", null,
                        React.createElement(ToggleField, { name: "is_compound", label: "Is compound", defaultValue: (rate === null || rate === void 0 ? void 0 : rate.isCompound) || false })),
                    React.createElement("div", null)),
                React.createElement("div", { className: "grid grid-cols-2 gap-5 mt-5" },
                    React.createElement("div", null,
                        React.createElement(NumberField, { name: "priority", label: "Priority", placeholder: "Priority", validation: { required: 'Priority is required' }, required: true, defaultValue: rate === null || rate === void 0 ? void 0 : rate.priority })),
                    React.createElement("div", null))),
            React.createElement(Card.Session, null,
                React.createElement("div", { className: "flex justify-end gap-2" },
                    React.createElement(Button, { title: "Cancel", variant: "secondary", onAction: closeModal }),
                    React.createElement(Button, { title: "Save", variant: "primary", onAction: () => {
                            document.getElementById('taxRateForm').dispatchEvent(new Event('submit', {
                                cancelable: true,
                                bubbles: true
                            }));
                        } }))))));
}
export { RateForm };
//# sourceMappingURL=RateForm.js.map