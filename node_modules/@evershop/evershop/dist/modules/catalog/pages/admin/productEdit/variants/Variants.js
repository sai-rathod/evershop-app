import { Card } from '@components/admin/Card.js';
import React from 'react';
import { useQuery } from 'urql';
import { CreateVariant } from './CreateVariant.js';
import { Skeleton } from './Skeleton.js';
import { Variant } from './Variant.js';
export const VariantQuery = `
query Query($productId: ID!) {
  product(id: $productId) {
    variantGroup {
      items {
        id
        attributes {
          attributeId
          attributeCode
          optionId
          optionText
        }
        product {
          productId
          uuid
          name
          sku
          qty
          status
          urlKey
          visibility
          price {
            regular {
              value
              currency
              text
            }
          }
          inventory {
            qty
            isInStock
            stockAvailability
            manageStock
          }
          editUrl
          updateApi
          image {
            uuid
            url
          }
          gallery {
            uuid
            url
          }
        }
      }
    }
  }
}
`;
export const Variants = ({ productId, variantGroup, createProductApi }) => {
    var _a;
    const [result, reexecuteQuery] = useQuery({
        query: VariantQuery,
        variables: {
            productId
        }
    });
    const refresh = () => {
        reexecuteQuery({ requestPolicy: 'network-only' });
    };
    const { data, fetching, error } = result;
    if (fetching) {
        return (React.createElement("div", { className: "p-2 flex justify-center items-center" },
            React.createElement(Skeleton, null)));
    }
    if (error) {
        return React.createElement("p", { className: "text-critical" }, error.message);
    }
    return (React.createElement(Card.Session, null,
        React.createElement("div", { className: "variant-list overflow-x-scroll" },
            React.createElement("table", null,
                React.createElement("thead", null,
                    React.createElement("tr", null,
                        React.createElement("th", null, "Image"),
                        variantGroup.attributes.map((attribute) => (React.createElement("th", { key: attribute.attributeId }, attribute.attributeName))),
                        React.createElement("th", null, "SKU"),
                        React.createElement("th", null, "Price"),
                        React.createElement("th", null, "Stock"),
                        React.createElement("th", null, "Status"),
                        React.createElement("th", null, "Actions"))),
                React.createElement("tbody", null, (((_a = data.product.variantGroup) === null || _a === void 0 ? void 0 : _a.items) || [])
                    .filter((v) => v.product.productId !== productId)
                    .map((v) => (React.createElement(Variant, { key: v.id, variant: v, refresh: refresh, variantGroup: variantGroup })))))),
        React.createElement("div", { className: "self-center" },
            React.createElement(CreateVariant, { variantGroup: variantGroup, createProductApi: createProductApi, refresh: refresh }))));
};
//# sourceMappingURL=Variants.js.map